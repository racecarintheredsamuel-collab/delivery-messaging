{%- assign uid = 'eta-' | append: block.id -%}{%- assign show_eta_timeline_final = false -%}{%- assign eta_icon_size_final = 36 -%}{%- assign eta_connector_style_final = 'double-chevron' -%}{%- assign eta_connector_color_final = '#111827' -%}{%- assign eta_connector_use_main_color_final = true -%}{%- assign eta_connector_alignment_final = 'center' -%}{%- assign c_sz = 24 -%}{%- assign eta_color_final = '#111827' -%}{%- assign eta_use_main_icon_color_final = true -%}{%- assign show_eta_border_final = true -%}{%- assign eta_border_width_final = 0 -%}{%- assign eta_border_color_final = '#e5e7eb' -%}{%- assign eta_border_radius_final = 8 -%}{%- assign eta_background_color_final = '' -%}{%- assign eta_delivery_days_min_final = 3 -%}{%- assign eta_delivery_days_max_final = 5 -%}{%- assign eta_order_icon_final = 'clipboard-document-check' -%}{%- assign eta_shipping_icon_final = 'truck' -%}{%- assign eta_delivery_icon_final = 'home' -%}{%- assign eta_order_icon_style_final = 'solid' -%}{%- assign eta_shipping_icon_style_final = 'solid' -%}{%- assign eta_delivery_icon_style_final = 'solid' -%}{%- assign eta_label_order_final = 'Ordered' -%}{%- assign eta_label_shipping_final = 'Shipped' -%}{%- assign eta_label_delivery_final = 'Delivered' -%}{%- assign eta_gap_icon_label_final = 2 -%}{%- assign eta_gap_label_date_final = 0 -%}{%- assign eta_horizontal_gap_final = 12 -%}{%- assign eta_padding_horizontal_final = 8 -%}{%- assign eta_padding_vertical_final = 8 -%}{%- assign cutoff_time_final = '14:00' -%}{%- assign cutoff_time_sat_final = '' -%}{%- assign cutoff_time_sun_final = '' -%}{%- assign closed_days_final = '' -%}{%- assign lead_time_final = 0 -%}{%- assign courier_no_delivery_days_final = 'sat,sun' -%}{%- assign bank_holiday_country_final = '' -%}{%- assign custom_holidays_final = '' -%}{%- assign icon_color = '#111827' -%}{%- assign eta_use_theme_font_final = true -%}{%- assign eta_match_messages_font_final = false -%}{%- assign eta_custom_font_family_final = '' -%}{%- assign use_theme_font_final = true -%}{%- assign custom_font_family_final = '' -%}{%- assign eta_use_theme_text_styling_final = true -%}{%- assign eta_label_color_final = '' -%}{%- assign eta_label_font_size_final = 'small' -%}{%- assign eta_label_font_weight_final = 'normal' -%}{%- assign eta_date_color_final = '' -%}{%- assign eta_date_font_size_final = 'xsmall' -%}{%- assign eta_date_font_weight_final = 'normal' -%}{%- assign eta_margin_top = 0 -%}{%- assign eta_margin_bottom = 0 -%}{%- assign eta_alignment = 'left' -%}{%- assign eta_alignment_mobile = 'left' -%}
{%- assign rules_json = shop.metafields.delivery_rules.config.value -%}{%- assign rules_obj = nil -%}{%- assign rules = nil -%}{%- if rules_json != blank -%}{%- assign rules_obj = rules_json | parse_json -%}{%- if rules_obj.version == 2 -%}{%- assign live_profile_id = rules_obj.liveProfileId | strip -%}{%- assign found_profile = false -%}{%- for profile in rules_obj.profiles -%}{%- assign profile_id_check = profile.id | strip -%}{%- if profile_id_check == live_profile_id -%}{%- assign rules = profile.rules -%}{%- assign found_profile = true -%}{%- break -%}{%- endif -%}{%- endfor -%}{%- if found_profile == false and rules_obj.profiles.size > 0 -%}{%- assign rules = rules_obj.profiles.first.rules -%}{%- endif -%}{%- else -%}{%- assign rules = rules_obj.rules -%}{%- endif -%}{%- endif -%}{%- assign global_settings_json = shop.metafields.delivery_rules.settings.value -%}{%- assign global_settings = nil -%}{%- if global_settings_json != blank -%}{%- assign global_settings = global_settings_json | parse_json -%}{%- endif -%}{%- if global_settings != nil -%}{%- if global_settings.cutoff_time != blank -%}{%- assign cutoff_time_final = global_settings.cutoff_time -%}{%- endif -%}{%- if global_settings.cutoff_time_sat != blank -%}{%- assign cutoff_time_sat_final = global_settings.cutoff_time_sat -%}{%- endif -%}{%- if global_settings.cutoff_time_sun != blank -%}{%- assign cutoff_time_sun_final = global_settings.cutoff_time_sun -%}{%- endif -%}{%- if global_settings.closed_days != blank -%}{%- assign closed_days_final = global_settings.closed_days | join: ',' -%}{%- endif -%}{%- if global_settings.lead_time != blank -%}{%- assign lead_time_final = global_settings.lead_time -%}{%- endif -%}{%- if global_settings.courier_no_delivery_days != blank -%}{%- assign courier_no_delivery_days_final = global_settings.courier_no_delivery_days | join: ',' -%}{%- endif -%}{%- if global_settings.bank_holiday_country != blank -%}{%- assign bank_holiday_country_final = global_settings.bank_holiday_country -%}{%- endif -%}{%- if global_settings.custom_holidays != blank -%}{%- assign custom_holidays_dates = '' -%}{%- for holiday in global_settings.custom_holidays -%}{%- if custom_holidays_dates != '' -%}{%- assign custom_holidays_dates = custom_holidays_dates | append: ',' -%}{%- endif -%}{%- assign custom_holidays_dates = custom_holidays_dates | append: holiday.date -%}{%- endfor -%}{%- assign custom_holidays_final = custom_holidays_dates -%}{%- endif -%}{%- if global_settings.use_theme_font == false -%}{%- assign use_theme_font_final = false -%}{%- endif -%}{%- if global_settings.custom_font_family != blank -%}{%- assign custom_font_family_final = global_settings.custom_font_family -%}{%- endif -%}{%- if global_settings.eta_use_theme_font == false or global_settings.eta_use_theme_font == 'false' -%}{%- assign eta_use_theme_font_final = false -%}{%- endif -%}{%- if global_settings.eta_match_messages_font == true or global_settings.eta_match_messages_font == 'true' -%}{%- assign eta_match_messages_font_final = true -%}{%- endif -%}{%- if global_settings.eta_custom_font_family != blank -%}{%- assign eta_custom_font_family_final = global_settings.eta_custom_font_family -%}{%- endif -%}{%- if global_settings.eta_use_theme_text_styling == false -%}{%- assign eta_use_theme_text_styling_final = false -%}{%- if global_settings.eta_label_color != blank -%}{%- assign eta_label_color_final = global_settings.eta_label_color -%}{%- endif -%}{%- if global_settings.eta_label_font_size != blank -%}{%- assign eta_label_font_size_final = global_settings.eta_label_font_size -%}{%- endif -%}{%- if global_settings.eta_label_font_weight != blank -%}{%- assign eta_label_font_weight_final = global_settings.eta_label_font_weight -%}{%- endif -%}{%- if global_settings.eta_date_color != blank -%}{%- assign eta_date_color_final = global_settings.eta_date_color -%}{%- endif -%}{%- if global_settings.eta_date_font_size != blank -%}{%- assign eta_date_font_size_final = global_settings.eta_date_font_size -%}{%- endif -%}{%- if global_settings.eta_date_font_weight != blank -%}{%- assign eta_date_font_weight_final = global_settings.eta_date_font_weight -%}{%- endif -%}{%- endif -%}{%- if global_settings.eta_margin_top != blank -%}{%- assign eta_margin_top = global_settings.eta_margin_top -%}{%- endif -%}
{%- if global_settings.eta_margin_bottom != blank -%}{%- assign eta_margin_bottom = global_settings.eta_margin_bottom -%}{%- endif -%}{%- if global_settings.eta_alignment != blank -%}{%- assign eta_alignment = global_settings.eta_alignment -%}{%- endif -%}{%- if global_settings.eta_alignment_mobile != blank -%}{%- assign eta_alignment_mobile = global_settings.eta_alignment_mobile -%}{%- endif -%}{%- if global_settings.eta_gap_icon_label != blank -%}{%- assign eta_gap_icon_label_final = global_settings.eta_gap_icon_label -%}{%- endif -%}{%- if global_settings.eta_gap_label_date != blank -%}{%- assign eta_gap_label_date_final = global_settings.eta_gap_label_date -%}{%- endif -%}{%- if global_settings.eta_horizontal_gap != blank -%}{%- assign eta_horizontal_gap_final = global_settings.eta_horizontal_gap -%}{%- endif -%}{%- if global_settings.eta_padding_horizontal != blank -%}{%- assign eta_padding_horizontal_final = global_settings.eta_padding_horizontal -%}{%- endif -%}{%- if global_settings.eta_padding_vertical != blank -%}{%- assign eta_padding_vertical_final = global_settings.eta_padding_vertical -%}{%- endif -%}{%- if global_settings.eta_connector_alignment != blank -%}{%- assign eta_connector_alignment_final = global_settings.eta_connector_alignment -%}{%- endif -%}{%- endif -%}{%- assign eta_font_family_css = nil -%}{%- if eta_use_theme_font_final == false -%}{%- if eta_match_messages_font_final and custom_font_family_final != blank -%}{%- assign eta_font_family_css = custom_font_family_final | append: ', sans-serif' -%}{%- elsif eta_custom_font_family_final != blank -%}{%- assign eta_font_family_css = eta_custom_font_family_final | append: ', sans-serif' -%}{%- endif -%}{%- endif -%}{%- assign any_rule_matched = false -%}{%- if product and rules and rules.size > 0 -%}
{%- assign product_handle = product.handle -%}{%- for r in rules -%}{%- assign m = r.match -%}{%- assign handle_match = false -%}{%- assign tag_match = false -%}{%- if m.product_handles and m.product_handles.size > 0 and m.product_handles contains product_handle -%}{%- assign handle_match = true -%}{%- endif -%}{%- if m.tags and m.tags.size > 0 -%}{%- for tg in m.tags -%}{%- if product.tags contains tg -%}{%- assign tag_match = true -%}{% break %}{%- endif -%}{%- endfor -%}{%- endif -%}{%- assign stock_match = true -%}{%- assign stock_status_value = m.stock_status | default: 'any' -%}{%- if stock_status_value != 'any' -%}{%- assign has_stock = false -%}{%- assign is_pre_order = false -%}{%- assign is_mixed_stock = false -%}{%- assign has_in_stock_variant = false -%}{%- assign has_out_of_stock_variant = false -%}{%- assign has_preorder_variant = false -%}{%- for variant in product.variants -%}{%- if variant.available and variant.inventory_quantity > 0 -%}{%- assign has_in_stock_variant = true -%}{%- elsif variant.available and variant.inventory_quantity <= 0 -%}{%- assign has_preorder_variant = true -%}{%- elsif variant.available == false -%}{%- assign has_out_of_stock_variant = true -%}{%- endif -%}{%- endfor -%}{%- assign status_count = 0 -%}{%- if has_in_stock_variant -%}{%- assign status_count = status_count | plus: 1 -%}{%- endif -%}{%- if has_out_of_stock_variant -%}{%- assign status_count = status_count | plus: 1 -%}{%- endif -%}{%- if has_preorder_variant -%}{%- assign status_count = status_count | plus: 1 -%}{%- endif -%}{%- if status_count > 1 -%}{%- assign is_mixed_stock = true -%}{%- endif -%}{%- if product.available -%}{%- assign has_stock = true -%}{%- if has_in_stock_variant == false and has_preorder_variant -%}{%- assign is_pre_order = true -%}{%- endif -%}{%- endif -%}{%- if stock_status_value == 'in_stock' and has_stock == false -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'in_stock' and is_pre_order == true -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'in_stock' and is_mixed_stock == true -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'out_of_stock' and has_stock == true -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'pre_order' and is_pre_order == false -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'pre_order' and is_mixed_stock == true -%}{%- assign stock_match = false -%}{%- endif -%}{%- if stock_status_value == 'mixed_stock' and is_mixed_stock == false -%}{%- assign stock_match = false -%}{%- endif -%}{%- endif -%}{%- assign final_match = false -%}{%- if m.is_fallback == true or m.is_fallback == 'true' -%}{%- if stock_match -%}{%- assign final_match = true -%}{%- endif -%}{%- elsif handle_match or tag_match -%}{%- if stock_match -%}{%- assign final_match = true -%}{%- endif -%}{%- endif -%}{%- if final_match -%}{%- assign any_rule_matched = true -%}{%- assign s = r.settings -%}{%- if s.icon_color != blank -%}{%- assign icon_color = s.icon_color -%}{%- endif -%}{%- if s.override_cutoff_times == true or s.override_cutoff_times == 'true' -%}{%- if s.cutoff_time != blank -%}{%- assign cutoff_time_final = s.cutoff_time -%}{%- endif -%}{%- if s.cutoff_time_sat != blank -%}{%- assign cutoff_time_sat_final = s.cutoff_time_sat -%}{%- endif -%}{%- if s.cutoff_time_sun != blank -%}{%- assign cutoff_time_sun_final = s.cutoff_time_sun -%}{%- endif -%}{%- endif -%}{%- if s.override_lead_time == true or s.override_lead_time == 'true' -%}{%- if s.lead_time != blank -%}{%- assign lead_time_final = s.lead_time -%}{%- endif -%}{%- endif -%}{%- if s.override_closed_days == true or s.override_closed_days == 'true' -%}{%- assign closed_days_final = s.closed_days | join: ',' -%}{%- endif -%}{%- if s.override_courier_no_delivery_days == true or s.override_courier_no_delivery_days == 'true' -%}{%- assign courier_no_delivery_days_final = s.courier_no_delivery_days | join: ',' -%}{%- endif -%}{%- if s.show_eta_timeline == true or s.show_eta_timeline == 'true' -%}{%- assign show_eta_timeline_final = true -%}{%- endif -%}{%- if s.show_eta_timeline == false -%}{%- assign show_eta_timeline_final = false -%}{%- endif -%}{%- if s.eta_icon_size != blank -%}{%- assign eta_icon_size_final = s.eta_icon_size -%}{%- endif -%}{%- if s.eta_connector_style != blank -%}{%- assign eta_connector_style_final = s.eta_connector_style -%}{%- endif -%}
{%- if s.eta_connector_color != blank -%}{%- assign eta_connector_color_final = s.eta_connector_color -%}{%- endif -%}{%- if s.eta_connector_use_main_color == true or s.eta_connector_use_main_color == 'true' -%}{%- assign eta_connector_use_main_color_final = true -%}{%- endif -%}{%- if s.eta_connector_use_main_color == false or s.eta_connector_use_main_color == 'false' -%}{%- assign eta_connector_use_main_color_final = false -%}{%- endif -%}{%- if s.eta_connector_alignment != blank -%}{%- assign eta_connector_alignment_final = s.eta_connector_alignment -%}{%- endif -%}{%- if s.eta_connector_size != blank -%}{%- assign c_sz = s.eta_connector_size -%}{%- endif -%}{%- if s.eta_color != blank -%}{%- assign eta_color_final = s.eta_color -%}{%- endif -%}{%- if s.eta_use_main_icon_color == true or s.eta_use_main_icon_color == 'true' -%}{%- assign eta_use_main_icon_color_final = true -%}{%- endif -%}{%- if s.eta_use_main_icon_color == false or s.eta_use_main_icon_color == 'false' -%}{%- assign eta_use_main_icon_color_final = false -%}{%- endif -%}{%- if s.show_eta_border == true or s.show_eta_border == 'true' -%}{%- assign show_eta_border_final = true -%}{%- endif -%}{%- if s.show_eta_border == false or s.show_eta_border == 'false' -%}{%- assign show_eta_border_final = false -%}{%- endif -%}{%- if s.eta_border_width != blank -%}{%- assign eta_border_width_final = s.eta_border_width -%}{%- endif -%}{%- if eta_border_width_final > 0 -%}{%- assign show_eta_border_final = true -%}{%- endif -%}{%- if s.eta_border_color != blank -%}{%- assign eta_border_color_final = s.eta_border_color -%}{%- endif -%}{%- if s.eta_border_radius != blank -%}{%- assign eta_border_radius_final = s.eta_border_radius -%}{%- endif -%}{%- if s.eta_background_color != blank -%}{%- assign eta_background_color_final = s.eta_background_color -%}{%- endif -%}{%- if s.eta_delivery_days_min != blank -%}{%- assign eta_delivery_days_min_final = s.eta_delivery_days_min -%}{%- endif -%}{%- if s.eta_delivery_days_max != blank -%}{%- assign eta_delivery_days_max_final = s.eta_delivery_days_max -%}{%- endif -%}{%- if s.eta_order_icon != blank -%}{%- assign eta_order_icon_final = s.eta_order_icon -%}{%- endif -%}{%- if s.eta_shipping_icon != blank -%}{%- assign eta_shipping_icon_final = s.eta_shipping_icon -%}{%- endif -%}{%- if s.eta_delivery_icon != blank -%}{%- assign eta_delivery_icon_final = s.eta_delivery_icon -%}{%- endif -%}{%- if s.eta_order_icon_style != blank -%}{%- assign eta_order_icon_style_final = s.eta_order_icon_style -%}{%- endif -%}{%- if s.eta_shipping_icon_style != blank -%}{%- assign eta_shipping_icon_style_final = s.eta_shipping_icon_style -%}{%- endif -%}{%- if s.eta_delivery_icon_style != blank -%}{%- assign eta_delivery_icon_style_final = s.eta_delivery_icon_style -%}{%- endif -%}{%- if s.eta_label_order != blank -%}{%- assign eta_label_order_final = s.eta_label_order -%}{%- endif -%}{%- if s.eta_label_shipping != blank -%}{%- assign eta_label_shipping_final = s.eta_label_shipping -%}{%- endif -%}{%- if s.eta_label_delivery != blank -%}{%- assign eta_label_delivery_final = s.eta_label_delivery -%}{%- endif -%}{%- if s.override_eta_text_styling == true or s.override_eta_text_styling == 'true' -%}{%- assign eta_use_theme_text_styling_final = false -%}{%- if s.eta_label_color != blank -%}{%- assign eta_label_color_final = s.eta_label_color -%}{%- endif -%}
{%- if s.eta_label_font_size != blank -%}{%- assign eta_label_font_size_final = s.eta_label_font_size -%}{%- endif -%}{%- if s.eta_label_font_weight != blank -%}{%- assign eta_label_font_weight_final = s.eta_label_font_weight -%}{%- endif -%}{%- if s.eta_date_color != blank -%}{%- assign eta_date_color_final = s.eta_date_color -%}{%- endif -%}{%- if s.eta_date_font_size != blank -%}{%- assign eta_date_font_size_final = s.eta_date_font_size -%}{%- endif -%}{%- if s.eta_date_font_weight != blank -%}{%- assign eta_date_font_weight_final = s.eta_date_font_weight -%}{%- endif -%}{%- endif -%}{% break %}{%- endif -%}{%- endfor -%}{%- endif -%}{%- assign eta_label_color_css = nil -%}{%- assign eta_label_font_size_css = nil -%}{%- assign eta_label_font_weight_css = nil -%}{%- assign eta_date_color_css = nil -%}{%- assign eta_date_font_size_css = nil -%}{%- assign eta_date_font_weight_css = nil -%}{%- if eta_use_theme_text_styling_final == false -%}{%- if eta_label_color_final != blank -%}{%- assign eta_label_color_css = eta_label_color_final -%}{%- endif -%}{%- assign eta_label_fs_num = eta_label_font_size_final | plus: 0 -%}{%- if eta_label_fs_num > 0 -%}{%- assign eta_label_font_size_css = eta_label_font_size_final | append: 'px' -%}{%- else -%}{%- case eta_label_font_size_final -%}{%- when 'xsmall' -%}{%- assign eta_label_font_size_css = '11px' -%}{%- when 'medium' -%}{%- assign eta_label_font_size_css = '14px' -%}{%- when 'large' -%}{%- assign eta_label_font_size_css = '16px' -%}{%- else -%}{%- assign eta_label_font_size_css = '12px' -%}{%- endcase -%}{%- endif -%}{%- case eta_label_font_weight_final -%}{%- when 'bold' -%}{%- assign eta_label_font_weight_css = '700' -%}{%- else -%}{%- assign eta_label_font_weight_css = '400' -%}{%- endcase -%}{%- if eta_date_color_final != blank -%}{%- assign eta_date_color_css = eta_date_color_final -%}{%- endif -%}{%- assign eta_date_fs_num = eta_date_font_size_final | plus: 0 -%}{%- if eta_date_fs_num > 0 -%}{%- assign eta_date_font_size_css = eta_date_font_size_final | append: 'px' -%}{%- else -%}{%- case eta_date_font_size_final -%}{%- when 'xxsmall' -%}{%- assign eta_date_font_size_css = '10px' -%}{%- when 'small' -%}{%- assign eta_date_font_size_css = '12px' -%}{%- when 'medium' -%}{%- assign eta_date_font_size_css = '14px' -%}{%- else -%}{%- assign eta_date_font_size_css = '11px' -%}{%- endcase -%}{%- endif -%}{%- case eta_date_font_weight_final -%}{%- when 'bold' -%}{%- assign eta_date_font_weight_css = '700' -%}{%- else -%}{%- assign eta_date_font_weight_css = '400' -%}{%- endcase -%}{%- endif -%}{%- if request.design_mode -%}
{{ 'dib-messages.css' | asset_url | stylesheet_tag }}
<div style="text-align:{{ eta_alignment }}"><div class="dib-placeholder"><div><b>ETA Timeline</b><br><span>Enable "Show ETA Timeline" in rules to display here.</span></div></div></div>
{%- elsif any_rule_matched and show_eta_timeline_final -%}
{%- assign i_px = eta_icon_size_final | default: 36 -%}{%- assign ca_a = '' -%}{%- assign ca_b = '' -%}{%- assign ca_l = '' -%}{%- assign ca_c = '' -%}{%- assign c_as = c_sz | times: 45 | divided_by: 100 -%}{%- assign c_h = c_sz | divided_by: 2 -%}{%- assign a_h = c_as | divided_by: 2 -%}{%- if eta_connector_alignment_final == 'icon' -%}{%- assign mt_a = i_px | divided_by: 2 | minus: a_h -%}{%- assign mt_b = i_px | divided_by: 2 | minus: c_h -%}{%- assign mt_l = i_px | divided_by: 2 | minus: 1 -%}{%- assign mt_c = i_px | divided_by: 2 | minus: c_h -%}{%- assign ca_a = 'margin-top:' | append: mt_a | append: 'px;' -%}{%- assign ca_b = 'margin-top:' | append: mt_b | append: 'px;' -%}{%- assign ca_l = 'margin-top:' | append: mt_l | append: 'px;' -%}{%- assign ca_c = 'margin-top:' | append: mt_c | append: 'px;' -%}{%- endif -%}{%- assign c_lw = c_sz | plus: 16 -%}{%- assign c_cw = c_sz | plus: 4 -%}{%- assign eta_icon_color = icon_color -%}
{%- if eta_use_main_icon_color_final == false -%}{%- assign eta_icon_color = eta_color_final -%}{%- endif -%}{%- assign eta_connector_color = eta_icon_color -%}{%- if eta_connector_use_main_color_final == false -%}{%- assign eta_connector_color = eta_connector_color_final -%}{%- endif -%}{%- if eta_use_theme_font_final == false -%}{%- assign ftl = nil -%}{%- if eta_match_messages_font_final and custom_font_family_final != blank -%}{%- assign ftl = custom_font_family_final -%}{%- elsif eta_custom_font_family_final != blank -%}{%- assign ftl = eta_custom_font_family_final -%}{%- endif -%}{%- if ftl != blank -%}<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family={{ ftl | replace: ' ', '+' }}:wght@400;700&display=swap" rel="stylesheet">{%- endif -%}{%- endif -%}{%- assign shipping_days_ahead = 1 -%}{%- capture eta_order_icon_markup -%}{%- if eta_order_icon_final contains 'custom-' -%}{%- assign custom_idx_str = eta_order_icon_final | remove: 'custom-' -%}{%- assign custom_idx = custom_idx_str | minus: 1 -%}{%- if global_settings != nil and global_settings.custom_icons != blank and global_settings.custom_icons.size > custom_idx -%}{%- assign custom_icon = global_settings.custom_icons[custom_idx] -%}{%- if custom_icon.svg != blank -%}{{ custom_icon.svg }}{%- elsif custom_icon.url != blank -%}<img src="{{ custom_icon.url }}" alt="" width="100%" height="100%" loading="lazy" style="object-fit:contain;display:block;width:100%;height:100%">{%- endif -%}{%- endif -%}{%- else -%}{%- render 'icon', icon: eta_order_icon_final, style: eta_order_icon_style_final -%}{%- endif -%}{%- endcapture -%}
{%- capture eta_shipping_icon_markup -%}{%- if eta_shipping_icon_final contains 'custom-' -%}{%- assign custom_idx_str = eta_shipping_icon_final | remove: 'custom-' -%}{%- assign custom_idx = custom_idx_str | minus: 1 -%}{%- if global_settings != nil and global_settings.custom_icons != blank and global_settings.custom_icons.size > custom_idx -%}{%- assign custom_icon = global_settings.custom_icons[custom_idx] -%}{%- if custom_icon.svg != blank -%}{{ custom_icon.svg }}{%- elsif custom_icon.url != blank -%}<img src="{{ custom_icon.url }}" alt="" width="100%" height="100%" loading="lazy" style="object-fit:contain;display:block;width:100%;height:100%">{%- endif -%}{%- endif -%}{%- else -%}{%- render 'icon', icon: eta_shipping_icon_final, style: eta_shipping_icon_style_final -%}{%- endif -%}{%- endcapture -%}
{%- capture eta_delivery_icon_markup -%}{%- if eta_delivery_icon_final contains 'custom-' -%}{%- assign custom_idx_str = eta_delivery_icon_final | remove: 'custom-' -%}{%- assign custom_idx = custom_idx_str | minus: 1 -%}{%- if global_settings != nil and global_settings.custom_icons != blank and global_settings.custom_icons.size > custom_idx -%}{%- assign custom_icon = global_settings.custom_icons[custom_idx] -%}{%- if custom_icon.svg != blank -%}{{ custom_icon.svg }}{%- elsif custom_icon.url != blank -%}<img src="{{ custom_icon.url }}" alt="" width="100%" height="100%" loading="lazy" style="object-fit:contain;display:block;width:100%;height:100%">{%- endif -%}{%- endif -%}{%- else -%}{%- render 'icon', icon: eta_delivery_icon_final, style: eta_delivery_icon_style_final -%}{%- endif -%}{%- endcapture -%}
{{ 'dib-messages.css' | asset_url | stylesheet_tag }}
<style>.dib-eta-timeline-block,.dib-eta-timeline-block .dib-eta-timeline{text-align:{{ eta_alignment }}!important}.dib-eta-timeline-block .dib-eta-stages{gap:{{ eta_horizontal_gap_final }}px!important}{% if eta_font_family_css %}#{{ uid }} .dib-eta-label,#{{ uid }} .dib-eta-date{font-family:{{ eta_font_family_css }}}{% endif %}{% if eta_use_theme_text_styling_final == false %}#{{ uid }} .dib-eta-label{font-size:{{ eta_label_font_size_css }};font-weight:{{ eta_label_font_weight_css }};{% if eta_label_color_css %}color:{{ eta_label_color_css }}{% endif %}}#{{ uid }} .dib-eta-date{font-size:{{ eta_date_font_size_css }};font-weight:{{ eta_date_font_weight_css }};{% if eta_date_color_css %}color:{{ eta_date_color_css }}{% endif %}}{% endif %}</style>
<div id="{{ uid }}" class="dib-eta-timeline-block" style="{% if eta_alignment_mobile != blank %}--dib-align-mobile:{{ eta_alignment_mobile }};{% endif %}{% if eta_margin_top != 0 %}margin-top:{{ eta_margin_top }}px;{% endif %}{% if eta_margin_bottom != 0 %}margin-bottom:{{ eta_margin_bottom }}px;{% endif %}">
<div class="dib-eta-timeline" style="margin:16px 0;" data-dib-js data-uid="{{ uid }}" data-delivery-min="{{ eta_delivery_days_min_final }}" data-delivery-max="{{ eta_delivery_days_max_final }}" data-shop-offset="{{ 'now' | date: '%z' }}" data-cutoff="{{ cutoff_time_final }}" data-cutoff-sat="{{ cutoff_time_sat_final }}" data-cutoff-sun="{{ cutoff_time_sun_final }}" data-closed-days="{{ closed_days_final }}" data-lead-time="{{ lead_time_final }}" data-courier-no-delivery="{{ courier_no_delivery_days_final }}" data-bank-holiday-country="{{ bank_holiday_country_final }}" data-custom-holidays="{{ custom_holidays_final }}">
<div class="dib-eta-scale-wrapper">
<div class="dib-eta-stages" style="display:flex;{% if eta_connector_alignment_final == 'icon' %}align-items:flex-start;{% else %}align-items:center;{% endif %}padding:{{ eta_padding_vertical_final }}px {{ eta_padding_horizontal_final }}px;{% if show_eta_border_final and eta_border_width_final > 0 %}border:{{ eta_border_width_final }}px solid {{ eta_border_color_final }};border-radius:{{ eta_border_radius_final }}px;{% endif %}{% if eta_background_color_final != blank %}background-color:{{ eta_background_color_final }};{% unless show_eta_border_final and eta_border_width_final > 0 %}border-radius:{{ eta_border_radius_final }}px;{% endunless %}{% endif %}">
<div class="dib-eta-stage" style="flex:1;min-width:0;display:flex;flex-direction:column;align-items:center;text-align:center;"><div class="dib-eta-icon" style="width:{{ i_px }}px;height:{{ i_px }}px;margin-bottom:{{ eta_gap_icon_label_final }}px;color:{{ eta_icon_color }};">{{ eta_order_icon_markup }}</div><div class="dib-eta-label" style="line-height:1.3;margin-bottom:{{ eta_gap_label_date_final }}px;">{{ eta_label_order_final }}</div><div class="dib-eta-date" style="line-height:1.3;white-space:nowrap;">{{ 'now' | date: '%b %d' }}</div></div>
{%- if eta_connector_style_final == 'line' -%}<div style="display:flex;gap:0;margin:0 -4px;align-items:center;justify-content:center;flex:0 0 {{ c_lw }}px;{{ ca_l }}"><span style="display:block;width:{{ c_lw }}px;border-top:1.5px solid {{ eta_connector_color }};"></span></div>{%- elsif eta_connector_style_final == 'big-arrow' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-big-arrow', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'double-chevron' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'double-chevron-solid' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron-solid', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'dash' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-dash', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'custom' and global_settings.custom_connector_svg != blank -%}<div style="display:flex;align-items:center;justify-content:center;color:{{ eta_connector_color }};{{ ca_c }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{{ global_settings.custom_connector_svg }}</span></div>{%- else -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron', style: 'solid' %}</span></div>{%- endif -%}
<div class="dib-eta-stage" style="flex:1;min-width:0;display:flex;flex-direction:column;align-items:center;text-align:center;"><div class="dib-eta-icon" style="width:{{ i_px }}px;height:{{ i_px }}px;margin-bottom:{{ eta_gap_icon_label_final }}px;color:{{ eta_icon_color }};">{{ eta_shipping_icon_markup }}</div><div class="dib-eta-label" style="line-height:1.3;margin-bottom:{{ eta_gap_label_date_final }}px;">{{ eta_label_shipping_final }}</div><div class="dib-eta-date" style="line-height:1.3;white-space:nowrap;">{%- assign shipping_seconds = 86400 | times: shipping_days_ahead -%}{%- assign shipping_timestamp = 'now' | date: '%s' | plus: shipping_seconds -%}{{ shipping_timestamp | date: '%b %d' }}</div></div>
{%- if eta_connector_style_final == 'line' -%}<div style="display:flex;gap:0;margin:0 -4px;align-items:center;justify-content:center;flex:0 0 {{ c_lw }}px;{{ ca_l }}"><span style="display:block;width:{{ c_lw }}px;border-top:1.5px solid {{ eta_connector_color }};"></span></div>{%- elsif eta_connector_style_final == 'big-arrow' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-big-arrow', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'double-chevron' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'double-chevron-solid' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron-solid', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'dash' -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-dash', style: 'solid' %}</span></div>{%- elsif eta_connector_style_final == 'custom' and global_settings.custom_connector_svg != blank -%}<div style="display:flex;align-items:center;justify-content:center;color:{{ eta_connector_color }};{{ ca_c }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{{ global_settings.custom_connector_svg }}</span></div>{%- else -%}<div style="display:flex;align-items:center;justify-content:center;flex:0 0 {{ c_cw }}px;color:{{ eta_connector_color }};{{ ca_b }}"><span style="width:{{ c_sz }}px;height:{{ c_sz }}px;display:block;">{% render 'icon', icon: 'connector-double-chevron', style: 'solid' %}</span></div>{%- endif -%}
{%- assign delivery_min_total_days = shipping_days_ahead | plus: eta_delivery_days_min_final -%}{%- assign delivery_max_total_days = shipping_days_ahead | plus: eta_delivery_days_max_final -%}{%- assign delivery_min_seconds = 86400 | times: delivery_min_total_days -%}{%- assign delivery_max_seconds = 86400 | times: delivery_max_total_days -%}{%- assign delivery_min_timestamp = 'now' | date: '%s' | plus: delivery_min_seconds -%}{%- assign delivery_max_timestamp = 'now' | date: '%s' | plus: delivery_max_seconds -%}{%- assign min_month = delivery_min_timestamp | date: '%b' -%}{%- assign max_month = delivery_max_timestamp | date: '%b' -%}{%- assign is_cross_month = false -%}{%- if eta_delivery_days_min_final != eta_delivery_days_max_final and min_month != max_month -%}{%- assign is_cross_month = true -%}{%- endif -%}
<div class="dib-eta-stage" style="flex:1;min-width:0;display:flex;flex-direction:column;align-items:center;text-align:center;{% if is_cross_month %}margin-right:8px;{% endif %}"><div class="dib-eta-icon" style="width:{{ i_px }}px;height:{{ i_px }}px;margin-bottom:{{ eta_gap_icon_label_final }}px;color:{{ eta_icon_color }};">{{ eta_delivery_icon_markup }}</div><div class="dib-eta-label" style="line-height:1.3;margin-bottom:{{ eta_gap_label_date_final }}px;">{{ eta_label_delivery_final }}</div><div class="dib-eta-date" style="line-height:1.3;white-space:nowrap;">{%- if eta_delivery_days_min_final == eta_delivery_days_max_final -%}{{ delivery_min_timestamp | date: '%b %d' }}{%- else -%}{%- if min_month == max_month -%}{{ delivery_min_timestamp | date: '%b %d' }}-{{ delivery_max_timestamp | date: '%d' }}{%- else -%}{{ delivery_min_timestamp | date: '%b %d' }}-{{ delivery_max_timestamp | date: '%b %d' }}{%- endif -%}{%- endif -%}</div></div>
</div></div></div></div>
<script>(function(){if(window.__DIB_COUNTDOWN_LOADED__)return;if(!document.querySelector('[data-dib-js]'))return;window.__DIB_COUNTDOWN_LOADED__=true;var s=document.createElement("script");s.src="{{ 'dib-countdown.js' | asset_url }}";s.defer=true;document.head.appendChild(s)})();</script>
{%- endif -%}
{% schema %}
{"name":"ETA Timeline","target":"section","settings":[]}
{% endschema %}
